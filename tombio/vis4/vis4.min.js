(function(n,t){"use strict";function c(n){f=n.selected;h(f)}function h(u){var f,a,c,l;if(i.html(null),u){n("<div id='vis4TaxonHeader'>").text(u).appendTo(i);var s=document.getElementById("tbVis4Images").checked,v=document.getElementById("tbVis4Kb").checked,e=document.getElementById("tbVis4Text").checked,h=r.getTaxonHtmlFiles(u);e=e&&h.length>0;s=s&&r.getTaxonImages(u).length>0;s&&(f=n('<div style="position: relative">').appendTo(i),e&&f.css("display","inline-block").css("width","50%").css("float","right").css("padding","0 0 10px 10px"),f.html(r.getTaxonImagesDiv(u,f,o,!0,!0)));e&&(h.length>1&&(a=n('<div style="margin-bottom: 20px; display: inline">').appendTo(i),c=n("<select id='vis4html'><\/select>").appendTo(a),h.forEach(function(t,i){var r=n("<option/>").text(t.Caption).attr("value",i);c.append(r)}),c.selectmenu({change:function(n,t){r.showTaxonHtmlInfo(u,l,t.item.value)}}).selectmenu("menuWidget")),l=n("<div>").appendTo(i),r.showTaxonHtmlInfo(u,l,0));v&&(i.append(n("<h2>").text("Knowledge-base values")),i.append(r.showTaxonCharacterValues(t.oTaxa[u],!0)));f&&n(window).resize(function(){var n=f.find(".baseimage");n.trigger("change")})}}var s="vis4",u=t[s]={},i,f,e,o=0,r;u.Obj=function(n,t,i){i.visP.Obj.call(this,s,n,t,i);this.metadata.title="Full taxon details";this.metadata.authors="Burkmar, R.";this.metadata.year="2016";this.metadata.publisher="Field Studies Council";this.metadata.location="Shrewsbury, England";this.metadata.contact="richardb@field-studies-council.org";this.metadata.version="1.0"};u.Obj.prototype=Object.create(t.visP.Obj.prototype);u.Obj.prototype.initialise=function(){function s(t,i,r){var u=n('<div style="display: inline-block; vertical-align:top; margin-left: 20px">').appendTo(r);u.append(n("<input style='position: relative; top: 0.2em' checked='checked' type='checkbox' name='"+t+"' id='"+t+"'>"));u.append(n("<span>").text(i));u.change(function(){h(f)})}var o,u;r=this;this.charStateInput=!1;this.helpFiles=[t.tombiopath+"vis4/vis4Help.html",];o=n("<div>").appendTo(n(this.cssSel));o.css("display","flex");n(this.cssSel).append(o);this.controlsDiv=n("<div/>").css("width",210);o.append(this.controlsDiv);u=n("<div/>").css("flex-grow",1);o.append(u);e=Object.create(t.taxonSelect);e.control(this.controlsDiv,!1,c);s("tbVis4Images","Show images",u);s("tbVis4Kb","Show knowledge-base",u);s("tbVis4Text","Show text",u);i=n("<div>").css("margin","10px");u.append(i)};u.Obj.prototype.refresh=function(){n("#vis4taxon").selectmenu("menuWidget").css("height",200)};u.Obj.prototype.urlParams=function(t){var r=this,i;console.log("Vis 4 URL parameters:",t);t.opts&&(i=t.opts.split("-"),n("#tbVis4Text").prop("checked",i.indexOf("text")>-1),n("#tbVis4Images").prop("checked",i.indexOf("image")>-1),n("#tbVis4Kb").prop("checked",i.indexOf("kb")>-1));t.imgi&&(o=t.imgi);t.taxon&&(e.taxonClick(t.taxon.replace("%20"," ")),o=0)}})(jQuery,this.tombiovis);