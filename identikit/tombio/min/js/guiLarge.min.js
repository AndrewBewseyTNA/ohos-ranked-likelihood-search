!function(i,o){"use strict";o.gui.main={},o.gui.main.setSelectedTool=function(o){i("#tombioGuiLargeVisualisation").val()!=o&&i("#tombioGuiLargeVisualisation").val(o)},o.gui.main.resizeControlsAndTaxa=function(){if(i("#tombioGuiLargeControls").is(":visible")){var o=i("#tombioGuiLargeControls").width();i("#tombioGuiLargeTaxa").css("margin-left",o+10);var a=i("#tombioGuiLargeControls").height();i("#tombioGuiLargeControlsAndTaxa").css("min-height",a+10)}else i("#tombioGuiLargeTaxa").css("margin-left",0),i("#tombioGuiLargeControlsAndTaxa").css("min-height","0px")},o.gui.main.init=function(){i("#tombiod3vis").html(""),i("#tombiod3vis").css("position","relative"),i("<div>").attr("id","tombioGuiLarge").css("display","none").appendTo("#tombiod3vis"),i("<div>").attr("id","tombioGuiLargeDialog").css("padding","1em").css("display","none").css("position","absolute").css("background-color","white").css("border","5px solid black").css("width","100%").css("z-index","5000").css("z-index","5000").appendTo("#tombioGuiLarge"),i("<button>").text("Close").appendTo(i("#tombioGuiLargeDialog")).on("click",function(){i("#tombioGuiLargeDialog").hide()}),i("<div>").attr("id","tombioGuiLargeDialogTitle").appendTo(i("#tombioGuiLargeDialog")),i("<div>").attr("id","tombioGuiLargeDialogContents").appendTo(i("#tombioGuiLargeDialog")),i("<select>").attr("id","tombioGuiLargeVisualisation").appendTo("#tombioGuiLarge"),i("<div>").addClass("tombioNoSelect").attr("id","tombioGuiLargeControlsAndTaxa").appendTo("#tombioGuiLarge"),i("<div>").attr("id","tombioGuiLargeControls").appendTo("#tombioGuiLargeControlsAndTaxa"),i("<div>").attr("id","tombioGuiLargeTaxa").appendTo("#tombioGuiLargeControlsAndTaxa"),i("<div>").attr("id","currentVisInfo").css("display","none").appendTo("#tombioGuiLarge"),i("<div>").attr("id","kbInfo").css("display","none").appendTo("#tombioGuiLarge"),i("<div>").attr("id","visInfo").css("display","none").appendTo("#tombioGuiLarge"),i("<div>").attr("id","tombioCitation").css("display","none").appendTo("#tombioGuiLarge"),i("<div>").attr("id","mediaFilesCheck").css("display","none").appendTo("#tombioGuiLarge"),i("<div>").attr("id","tvkCheck").css("display","none").appendTo("#tombioGuiLarge"),o.gui.main.divVis="#tombioGuiLargeTaxa",o.gui.main.divInput="#tombioGuiLargeControls",o.f.checkInterface("guiLarge",o.templates.gui.main,o.gui.main)},o.gui.main.createUIControls=function(){i("#tombioGuiLarge").css("display","");var a=[];a.push(i('<option value="reload" class="html" data-class="reload">Reload</option>')),a.push(i('<option value="reloadGuiOnsen" class="html" data-class="reload">Reload with mobile-first interface</option>')),a.push(i('<option value="reloadGuiJQuery" class="html" data-class="reload">Reload with large format interface</option>')),o.v.includedVisualisations.forEach(function(t,e){var n=i('<option class="needsclick">').attr("value",t).attr("data-class","vis").addClass("visualisation").text(o.js.jsFiles[t].toolName);a.push(n)}),a.push(i('<option id="optCurrentVisInfo" value="currentVisInfo" class="html" data-class="info"></option>')),a.push(i('<option value="kbInfo" class="html" data-class="info">About the Knowledge-base</option>')),a.push(i('<option value="visInfo" class="html" data-class="info">About FSC Identikit</option>')),a.push(i('<option value="tombioCitation" class="html" data-class="info">Get citation text</option>')),o.opts.checkKB&&(a.push(i('<option value="mediaFilesCheck" class="html" data-class="wrench">Check media files</option>')),o.d.oCharacters.TVK&&a.push(i('<option value="tvkCheck" class="html" data-class="wrench">Check TVKs</option>'))),a.forEach(function(i){i.attr("value")==o.v.selectedTool&&i.attr("selected","selected")}),i("#tombioGuiLargeVisualisation").append(a),i("#tombioGuiLargeVisualisation").change(function(){o.f.visChanged(i("#tombioGuiLargeVisualisation").val())}),1==o.opts.hideVisDropdown&&i("#tombioGuiLargeVisualisation-button").hide()},o.gui.main.visShow=function(a){var t=o.v.visualisations[a];if("tombioCitation"==a&&i("#tombioCitation").html(o.f.createCitationPage()),"mediaFilesCheck"==a&&i("#mediaFilesCheck").html(o.f.createMediaCheckPage()),"tvkCheck"==a&&i("#tvkCheck").html(o.f.createTvkCheckPage()),"kbInfo"==a&&0==i("#kbInfo").html().length&&o.f.setKbInfo(i("#kbInfo")),"visInfo"==a&&0==i("#visInfo").html().length&&o.f.setVisInfo(i("#visInfo")),"currentVisInfo"==a&&(i("#currentVisInfo").html(""),o.f.setSelectedToolInfo(i("#currentVisInfo"))),console.log("selectedToolName",a),a!=o.v.currentTool&&(o.v.currentTool&&(o.v.visualisations[o.v.currentTool]?o.v.visualisations[o.v.currentTool].hide():i("#"+o.v.currentTool).hide()),o.v.visualisations[a]?o.v.visualisations[a].show():i("#"+a).show()),t?i("#tombioGuiLargeControlsAndTaxa").show():i("#tombioGuiLargeControlsAndTaxa").hide(),o.f.refreshVisualisation(),o.v.currentTool=a,Object.keys(o.v.visualisations).indexOf(a)>-1&&(o.v.lastVis=a,i("#optCurrentVisInfo").text("Using the "+o.v.visualisations[o.v.lastVis].metadata.title)),!o.v.initialised&&o.v.visualisations[a]){for(var e={},n=decodeURI(window.location.search.substring(1)).replace(/\+/g," ").split("&"),s=0;s<n.length;s++){var l=n[s].split("=");e[l[0]]=l[1]}o.v.visualisations[a].urlParams(e),o.v.initialised=!0}},o.gui.main.showFullDetails=function(a){var t=o.f.getTaxonCharacterValues(o.d.oTaxa[a]),e=i("<div>");if(o.f.addTaxonImagesToContainer({taxon:a,container:e,height:300}),o.d.oCharacters.TVK&&o.d.oTaxa[a].TVK){var n=i("<div>").css("position","relative");o.f.addNBNMapToContainer(o.d.oTaxa[a].TVK,n)}var s=i("<div>"),l=o.f.getTaxonHtmlFiles(a);if(0==l.length)s.text("No text information files (HTML) are specified in the knowledge-base for this taxon.");else{if(l.length>1){var r=i("<select id='tombioFileSelect'></select>").appendTo(s);l.forEach(function(o,a){var t=i("<option/>").text(o.Caption).attr("value",a);r.append(t)}),r.change(function(){o.f.addTaxonHtmlToContainer(a,d,i(this).val())})}var d=i("<div>").appendTo(s);o.f.addTaxonHtmlToContainer(a,d,0)}var u=i("<div>");u.append(t),u.append(e),u.append(s),n&&u.append(n),function(o){var a=i("<div style='background-color: white; position: absolute; z-index: 50000; padding: 20px'>");i("body").prepend(a),a.html(null),i("<button>").text("Dismiss").appendTo(a).click(function(){a.hide()}),a.append(o),a.show()}(u)},o.gui.main.createCharacterTooltips=function(i){},o.gui.main.createTaxonToolTips=function(i,o){},o.gui.main.tooltip=function(i){},o.gui.main.dialog=function(o,a){i("#tombioGuiLargeDialogTitle").text(o),i("#tombioGuiLargeDialogContents").html(a),i("#tombioGuiLargeDialog").show()},o.gui.main.contextMenu={},o.gui.main.contextMenu.addItem=function(){},o.gui.main.contextMenu.removeItem=function(){}}(jQuery,this.tombiovis);